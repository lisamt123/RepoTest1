<apex:page renderAs="pdf" controller="PanayaIA.EffortAssessment" action="{!init}">
    <head>
        <style>
            @page{
                size: A4;
                margin: 10mm;
                margin-top:3cm;
                /*@top-right{
                    content: "{!todaysDate}";
                    font-size: x-small;
                }*/
                @bottom-left{
                    content:  "Generated By: {!$User.FirstName}  {!$User.LastName} {!todaysDate}";
                    font-size: small;
                }
                /*
                @bottom-center{
                    content:  "Page " counter(page) " of " counter(pages)
                }
                @bottom-right{
                    content:  "{!Day(Today())}" '/' "{!Month(Today())}" '/' "{!Year(Today())}"
                }
                */
            }
        </style>
    </head>
    <apex:stylesheet value="{!URLFOR($Resource.PanayaIA__PanayaPDFStyleSheet)}"/>
    <div class="imageDiv">
        <img class="logoImage" src="{!URLFOR($Resource.PanayaIA__Panaya, 'img/36x36-icon.png')}"/>
    </div>
    <br/><br/><br/><br/>
    <div>
        <table style="border-collapse: collapse;">
            <tr>
                <td class="headerLabel">Object:</td>
                <td style="padding-left: 15px; color: black;">{!obj}</td>
            </tr>
            <tr>
                <td class="headerLabel">Field:</td>
                <td style="padding-left: 15px; color: black;">{!JSINHTMLENCODE(field)}</td>
            </tr>
            <apex:outputText rendered="{!if(len(value)>2,true,false)}">
                <td class="headerLabel">Value:</td>
                <td style="padding-left: 15px; color: black;">{!if(and(ps.analyzeType == 'User',ps.analyzeField=='Name'),ps.analyzeFieldLabel,ps.analyzeValue)}</td>
            </apex:outputText>
        </table>
    </div>
    <br/><br/>
    <div class="headerDiv">Impact Summary</div>
    <br/><br/>
    <table class="panayaTable">
        <tr class="panayaTableHeader">
            <th>Component Type</th>
            <th>Direct Impact</th>
            <th>Indirect Impact</th>
            <th>Total Impact</th>
        </tr>
        <apex:repeat value="{!ps.searchResultComponents}" var="sr">
            <tr>
                <td class="panayaTableFirstColumn">{!JSINHTMLENCODE(sr.EntityTypeLabel)}</td>
                <td>{!sr.directCount}</td>
                <td>{!sr.indirectCount}</td>
                <td>{!sr.directCount + sr.indirectCount}</td>
            </tr>
        </apex:repeat>
    </table>
    <br/><br/><br/><br/>
    <div class="headerDiv">Top Impacted Components</div>
    <br/><br/>
    <table class="panayaTable" style="text-align: left;">
        <tr class="panayaTableHeader">
            <th>Component Type</th>
            <th>Component Name</th>
            <th>Folder/Object</th>
            <th>Last Modified Date</th>
        </tr>
        <apex:repeat value="{!topResults}" var="result" rows="8">
            <tr>
                <td>{!JSINHTMLENCODE(result.componentType)}</td>
                <td>{!JSINHTMLENCODE(result.componentLabel)}</td>
                <td>
                    <apex:outputText rendered="{!if(or(result.componentType='Report',result.componentType='Dashboard'),true,false)}">{!JSINHTMLENCODE(result.folderLabel)}</apex:outputText>
                    <apex:outputtext rendered="{!if(or(result.componentType='Formula',result.componentType='Page Layout'),true,false)}">{!JSINHTMLENCODE(result.objName)}</apex:outputtext>
                </td>
                <td>{!JSINHTMLENCODE(result.lastModifiedDate)}</td>
            </tr>
        </apex:repeat>
    </table>
</apex:page>